(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{"ct+p":function(t,e,a){"use strict";a.r(e),a.d(e,"HomeModule",(function(){return _}));var n=a("ofXK"),o=a("tyNb"),r=a("fXoL"),i=a("lGQG"),c=a("mrSG"),s=a("tk/3"),u=a("3Pt+"),d=a("b6Qw"),l=a("dNgK"),m=a("JSOo"),b=a("Wp6s"),p=a("kmnG"),h=a("qFsG"),f=a("bTqV"),g=a("Xa2L");function w(t,e){if(1&t&&(r.Sb(0,"mat-error"),r.Cc(1),r.Rb()),2&t){const t=r.dc();r.Bb(1),r.Dc(t.alerta)}}let C=(()=>{class t{constructor(t,e,a,n,o){this.authService=t,this.router=e,this.cookieService=a,this.snackBar=n,this.commonService=o,this.valueChange=new r.o,this.titulo="Acceso CRM RADFPD"}ngOnInit(){this.setForm()}setForm(){this.loginForm=new u.h({username:new u.e("",u.v.required),password:new u.e("",u.v.required)})}acceder(){return Object(c.a)(this,void 0,void 0,(function*(){if(this.loginForm.valid){const t=this.loginForm.value,e=yield this.authService.doLogin(t).toPromise();e.ok&&(e.data.token?(localStorage.setItem("token",e.data.token),localStorage.setItem("usuario",e.data.usuario),localStorage.setItem("nombre_publico",e.data.nombre_publico),localStorage.setItem("ultimaOpcion",e.data.opcion),localStorage.setItem("ultimoGrupo",e.data.grupo),this.commonService.headers=new s.d({"Content-Type":"application/json",Authorization:"Bearer "+e.data.token}),this.router.navigate(["/"+e.data.accion])):0===e.data.valido?this.snackBar.open("Usuario inhabilitado","Cerrar",{duration:5e3}):1===e.data.valido&&this.snackBar.open("Usuario o contrase\xf1a incorrectas","Cerrar",{duration:5e3}))}}))}forgotPassword(){this.valueChange.emit(!0)}}return t.\u0275fac=function(e){return new(e||t)(r.Mb(i.a),r.Mb(o.d),r.Mb(d.a),r.Mb(l.a),r.Mb(m.a))},t.\u0275cmp=r.Gb({type:t,selectors:[["app-login"]],outputs:{valueChange:"valueChange"},decls:20,vars:5,consts:[[1,"example-card"],[1,"example-form",3,"formGroup"],[1,"form-group"],[1,"example-full-width"],["matInput","","placeholder","Correo electr\xf3nico","formControlName","username","name","username","type","text","required","",1,"form-control","full-width-input"],["matInput","","placeholder","Contrase\xf1a","formControlName","password","type","password","name","password","required","",1,"form-control","full-width-input"],["input2",""],["type","submit","mat-raised-button","",1,"azulVeo",3,"click"],["type","button","mat-raised-button","",1,"azulVeo",3,"click"],[4,"ngIf"]],template:function(t,e){1&t&&(r.Sb(0,"mat-card",0),r.Sb(1,"mat-card-header"),r.Sb(2,"mat-card-title"),r.Cc(3),r.Rb(),r.Rb(),r.Sb(4,"mat-card-content"),r.Sb(5,"form",1),r.Sb(6,"div",2),r.Sb(7,"mat-form-field",3),r.Nb(8,"input",4),r.Rb(),r.Rb(),r.Sb(9,"div",2),r.Sb(10,"mat-form-field",3),r.Nb(11,"input",5,6),r.Rb(),r.Rb(),r.Sb(13,"mat-card-actions"),r.Sb(14,"button",7),r.Zb("click",(function(){return e.acceder()})),r.Cc(15,"Acceder"),r.Rb(),r.Sb(16,"button",8),r.Zb("click",(function(){return e.forgotPassword()})),r.Cc(17," Olvid\xe9 mi contrase\xf1a "),r.Rb(),r.Rb(),r.Rb(),r.Nb(18,"mat-spinner"),r.Rb(),r.Bc(19,w,2,1,"mat-error",9),r.Rb()),2&t&&(r.Bb(3),r.Dc(e.titulo),r.Bb(2),r.jc("formGroup",e.loginForm),r.Bb(13),r.yc("display",e.showSpinner?"block":"none"),r.Bb(1),r.jc("ngIf",e.error))},directives:[b.a,b.d,b.g,b.c,u.w,u.p,u.i,p.c,h.b,u.c,u.o,u.g,u.u,b.b,f.a,g.b,n.l,p.b],styles:["mat-card[_ngcontent-%COMP%]{max-width:400px;margin:2em auto;text-align:center}.signin-content[_ngcontent-%COMP%]{padding:60px 1rem}.full-width-input[_ngcontent-%COMP%]{width:90%}.mat-form-field[_ngcontent-%COMP%]{display:inline}.mat-card-actions[_ngcontent-%COMP%], .mat-card-content[_ngcontent-%COMP%], .mat-card-subtitle[_ngcontent-%COMP%]{display:block;margin-bottom:16px;text-align:-webkit-center}  .mat-horizontal-stepper-header-container{display:none!important}"]}),t})();function v(t,e){if(1&t&&(r.Sb(0,"mat-error"),r.Cc(1),r.Rb()),2&t){const t=r.dc();r.Bb(1),r.Dc(t.alerta)}}let P=(()=>{class t{constructor(t,e){this.authService=t,this.snackBar=e,this.valueChange=new r.o}ngOnInit(){this.setForm()}setForm(){this.cambiarPasswordForm=new u.h({username:new u.e("",u.v.required)})}recuperarPass(){return Object(c.a)(this,void 0,void 0,(function*(){const t=yield this.authService.resetPassword(this.cambiarPasswordForm.value).toPromise();t.ok?(this.snackBar.open("Se ha enviado un correo de recuperaci\xf3n de contrase\xf1a a la direcci\xf3n indicada","Cerrar",{duration:5e3}),this.valueChange.emit(!1)):"usuario inexistente"===t.message&&this.snackBar.open("El usuario introducido no existe en nuestro sistema","Cerrar",{duration:5e3})}))}goBack(){this.valueChange.emit(!1)}}return t.\u0275fac=function(e){return new(e||t)(r.Mb(i.a),r.Mb(l.a))},t.\u0275cmp=r.Gb({type:t,selectors:[["app-recover-password"]],outputs:{valueChange:"valueChange"},decls:16,vars:4,consts:[[1,"example-card"],[1,"example-form",3,"formGroup","ngSubmit"],[1,"form-group"],[1,"example-full-width"],["matInput","","placeholder","Correo electr\xf3nico","formControlName","username","name","username","type","text","required","",1,"form-control","full-width-input"],["type","submit","mat-raised-button","",1,"azulVeo"],["type","button","mat-raised-button","",1,"azulVeo",3,"click"],[4,"ngIf"]],template:function(t,e){1&t&&(r.Sb(0,"mat-card",0),r.Sb(1,"mat-card-header"),r.Sb(2,"mat-card-title"),r.Cc(3,"Recuperar contrase\xf1a"),r.Rb(),r.Rb(),r.Sb(4,"mat-card-content"),r.Sb(5,"form",1),r.Zb("ngSubmit",(function(){return e.recuperarPass()})),r.Sb(6,"div",2),r.Sb(7,"mat-form-field",3),r.Nb(8,"input",4),r.Rb(),r.Rb(),r.Sb(9,"mat-card-actions"),r.Sb(10,"button",5),r.Cc(11,"Recuperar"),r.Rb(),r.Sb(12,"button",6),r.Zb("click",(function(){return e.goBack()})),r.Cc(13,"Volver"),r.Rb(),r.Rb(),r.Rb(),r.Nb(14,"mat-spinner"),r.Rb(),r.Bc(15,v,2,1,"mat-error",7),r.Rb()),2&t&&(r.Bb(5),r.jc("formGroup",e.cambiarPasswordForm),r.Bb(9),r.yc("display",e.showSpinner?"block":"none"),r.Bb(1),r.jc("ngIf",e.error))},directives:[b.a,b.d,b.g,b.c,u.w,u.p,u.i,p.c,h.b,u.c,u.o,u.g,u.u,b.b,f.a,g.b,n.l,p.b],styles:["mat-card[_ngcontent-%COMP%]{max-width:400px;margin:2em auto;text-align:center}.signin-content[_ngcontent-%COMP%]{padding:60px 1rem}.full-width-input[_ngcontent-%COMP%]{width:90%}.mat-form-field[_ngcontent-%COMP%]{display:inline}.mat-card-actions[_ngcontent-%COMP%], .mat-card-content[_ngcontent-%COMP%], .mat-card-subtitle[_ngcontent-%COMP%]{display:block;margin-bottom:16px;text-align:-webkit-center}  .mat-horizontal-stepper-header-container{display:none!important}"]}),t})();function S(t,e){1&t&&(r.Sb(0,"mat-card"),r.Sb(1,"mat-error"),r.Cc(2,"El enlace para cambiar su contrase\xf1a ha expirado"),r.Rb(),r.Rb())}let k=(()=>{class t{constructor(t,e){this.authService=t,this.snackBar=e,this.valueChanges=new r.o}ngOnInit(){this.setForm()}setForm(){this.resetPasswordForm=new u.h({token_pwd:new u.e(this.tokenPasswd,u.v.required),password:new u.e("",u.v.required),confirm_password:new u.e("",u.v.required)},this.contrasenaMatchValidator)}contrasenaMatchValidator(t){return t.get("password").value===t.get("confirm_password").value?null:{mismatch:!0}}generateNewPass(){return Object(c.a)(this,void 0,void 0,(function*(){if(this.resetPasswordForm.valid){const t=this.resetPasswordForm.value;(yield this.authService.generateNewPass(t).toPromise()).ok?(this.snackBar.open("Se ha cambiado la contrase\xf1a con \xe9xito","Cerrar",{duration:5e3}),this.valueChanges.emit(!1)):this.snackBar.open("No se ha podido cambiar la contrase\xf1a","Cerrar",{duration:5e3})}}))}changeInput(t){}}return t.\u0275fac=function(e){return new(e||t)(r.Mb(i.a),r.Mb(l.a))},t.\u0275cmp=r.Gb({type:t,selectors:[["app-reset-password"]],inputs:{tokenPasswd:"tokenPasswd"},outputs:{valueChanges:"valueChanges"},decls:25,vars:7,consts:[[1,"example-card"],[1,"example-form",3,"formGroup","ngSubmit"],[1,"form-group"],[1,"example-full-width"],["matInput","","placeholder","Contrase\xf1a","formControlName","password","type","password","name","password","required","",1,"form-control","full-width-input"],["input3",""],[1,"botonOjo",3,"click"],[1,"material-icons"],["matInput","","placeholder","Contrase\xf1a","formControlName","confirm_password","type","password","name","confirm_password","required","",1,"form-control","full-width-input"],["input4",""],["type","submit","mat-raised-button","",1,"azulVeo",3,"disabled"],[4,"ngIf"]],template:function(t,e){if(1&t){const t=r.Tb();r.Sb(0,"mat-card",0),r.Sb(1,"mat-card-header"),r.Sb(2,"mat-card-title"),r.Cc(3,"Recuperar contrase\xf1a"),r.Rb(),r.Rb(),r.Sb(4,"mat-card-content"),r.Sb(5,"form",1),r.Zb("ngSubmit",(function(){return e.generateNewPass()})),r.Sb(6,"div",2),r.Sb(7,"mat-form-field",3),r.Nb(8,"input",4,5),r.Sb(10,"label",6),r.Zb("click",(function(){r.tc(t);const a=r.qc(9);return e.changeInput(a)})),r.Sb(11,"i",7),r.Cc(12),r.Rb(),r.Rb(),r.Rb(),r.Rb(),r.Sb(13,"div",2),r.Sb(14,"mat-form-field",3),r.Nb(15,"input",8,9),r.Sb(17,"label",6),r.Zb("click",(function(){r.tc(t);const a=r.qc(16);return e.changeInput(a)})),r.Sb(18,"i",7),r.Cc(19),r.Rb(),r.Rb(),r.Rb(),r.Rb(),r.Sb(20,"mat-card-actions"),r.Sb(21,"button",10),r.Cc(22,"Cambiar"),r.Rb(),r.Rb(),r.Rb(),r.Nb(23,"mat-spinner"),r.Rb(),r.Rb(),r.Bc(24,S,3,0,"mat-card",11)}2&t&&(r.Bb(5),r.jc("formGroup",e.resetPasswordForm),r.Bb(7),r.Ec(" ",e.iconoPass," "),r.Bb(7),r.Ec(" ",e.iconoPass," "),r.Bb(2),r.jc("disabled",!e.resetPasswordForm.valid),r.Bb(2),r.yc("display",e.showSpinner?"block":"none"),r.Bb(1),r.jc("ngIf",!e.checkTokenPasswd&&e.resetPass))},directives:[b.a,b.d,b.g,b.c,u.w,u.p,u.i,p.c,h.b,u.c,u.o,u.g,u.u,b.b,f.a,g.b,n.l,p.b],styles:["mat-card[_ngcontent-%COMP%]{max-width:400px;margin:2em auto;text-align:center}.signin-content[_ngcontent-%COMP%]{padding:60px 1rem}.full-width-input[_ngcontent-%COMP%]{width:90%}.mat-form-field[_ngcontent-%COMP%]{display:inline}.mat-card-actions[_ngcontent-%COMP%], .mat-card-content[_ngcontent-%COMP%], .mat-card-subtitle[_ngcontent-%COMP%]{display:block;margin-bottom:16px;text-align:-webkit-center}  .mat-horizontal-stepper-header-container{display:none!important}"]}),t})();function R(t,e){if(1&t){const t=r.Tb();r.Sb(0,"app-login",4),r.Zb("valueChange",(function(e){return r.tc(t),r.dc().forgotPassword(e)})),r.Rb()}}function y(t,e){if(1&t){const t=r.Tb();r.Sb(0,"app-recover-password",4),r.Zb("valueChange",(function(e){return r.tc(t),r.dc().forgotPassword(e)})),r.Rb()}}function M(t,e){if(1&t){const t=r.Tb();r.Sb(0,"app-reset-password",5),r.Zb("valueChanges",(function(e){return r.tc(t),r.dc().resetPass(e)})),r.Rb()}if(2&t){const t=r.dc();r.jc("tokenPasswd",t.tokenPasswd)}}const x=[{path:"",component:(()=>{class t{constructor(t,e){this.authService=t,this.activatedRoute=e,this.formularioRecuperacion=!1,this.formularioReseteo=!1,this.checkTokenPasswd=!1,this.activatedRoute.queryParams.subscribe(t=>{this.tokenPasswd=t.token}),this.tokenPasswd&&(this.formularioReseteo=!0,this.checkPassToken(this.tokenPasswd))}ngOnInit(){}forgotPassword(t){this.formularioRecuperacion=t}resetPass(t){this.formularioReseteo=t}checkPassToken(t){this.authService.checkPassToken(t).subscribe(t=>{this.checkTokenPasswd=t.ok})}}return t.\u0275fac=function(e){return new(e||t)(r.Mb(i.a),r.Mb(o.a))},t.\u0275cmp=r.Gb({type:t,selectors:[["app-home"]],decls:5,vars:3,consts:[[1,"card","signin-content"],[1,"card-body"],[3,"valueChange",4,"ngIf"],[3,"tokenPasswd","valueChanges",4,"ngIf"],[3,"valueChange"],[3,"tokenPasswd","valueChanges"]],template:function(t,e){1&t&&(r.Sb(0,"div",0),r.Sb(1,"div",1),r.Bc(2,R,1,0,"app-login",2),r.Bc(3,y,1,0,"app-recover-password",2),r.Bc(4,M,1,1,"app-reset-password",3),r.Rb(),r.Rb()),2&t&&(r.Bb(2),r.jc("ngIf",!e.formularioRecuperacion&&!e.formularioReseteo),r.Bb(1),r.jc("ngIf",e.formularioRecuperacion&&!e.formularioReseteo),r.Bb(1),r.jc("ngIf",!e.formularioRecuperacion&&e.formularioReseteo))},directives:[n.l,C,P,k],styles:["mat-card[_ngcontent-%COMP%]{max-width:400px;margin:2em auto;text-align:center}.signin-content[_ngcontent-%COMP%]{padding:60px 1rem}.full-width-input[_ngcontent-%COMP%]{width:90%}.mat-form-field[_ngcontent-%COMP%]{display:inline}.mat-card-actions[_ngcontent-%COMP%], .mat-card-content[_ngcontent-%COMP%], .mat-card-subtitle[_ngcontent-%COMP%]{display:block;margin-bottom:16px;text-align:-webkit-center}  .mat-horizontal-stepper-header-container{display:none!important}"]}),t})()}];let O=(()=>{class t{}return t.\u0275mod=r.Kb({type:t}),t.\u0275inj=r.Jb({factory:function(e){return new(e||t)},imports:[[o.f.forChild(x)],o.f]}),t})();var B=a("ah4G");let _=(()=>{class t{}return t.\u0275mod=r.Kb({type:t}),t.\u0275inj=r.Jb({factory:function(e){return new(e||t)},imports:[[n.c,O,u.t,B.a]]}),t})()}}]);